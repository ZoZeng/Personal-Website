<! Github Contribution>
<html>
<head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>


</head>
<body>

<h2>Github Contribution</h2>

<p>This will display all the contributions of user within 365 days</p>

<form>
  User name:<br>
  <input type="text" name="username" id ="Username"><br>

</form>

<button> Start</button>

<script type = "text/javascript">
    var count = [];

    var total= 0;
    $("button").click(function(){
        var username = $('#Username').val();
        var url = 'https://api.github.com/users/'+username;



        var oneDay = 24*60*60*1000;
        for (i=0;i<365;i++){
            count[i]=0;
        }
        
        $(function(){
           $.ajax({
               type:'GET',
               dataType:'json',
               url:url+'/repos',
             
               success:function(data){


                       for( i=0;i<data.length;i++){

                          var createdTime = data[i].created_at;

                            var y = parseInt(createdTime.substring(0,4),10);
                            var m=parseInt(createdTime.substring(5,7),10);
                            var d =parseInt(createdTime.substring(8,10),10);
                            var date = new Date();
                            var date2 = new Date(y,m-1,d)
                            var diffDays = Math.round(Math.abs((date.getTime() - date2.getTime())/(oneDay)));
                            if(diffDays<=365){
                                    var index = 365 -diffDays;
                                    count[index]++;
                                    total++;
                                    console.log(total);
                                    console.log(count);
                            }

                            var reposUrl= data[i].url;

                            $.ajax({
                                type:'GET',

                                dataType:'json',
                                url:reposUrl+'/commits',

                                success:function(data1){
                                    for(j = 0; j<data1.length;j++){
                                        if(data1[j].commit.author.name.toLowerCase()===username){
                                           var time= data1[j].commit.author.date;
                                            var y = parseInt(time.substring(0,4),10);
                                            var m =  parseInt(time.substring(5,7),10);
                                            var d =  parseInt(time.substring(8,10),10);

                                                var date = new Date();
                                                var date2 = new Date(y,m-1,d );
                                                var diffDays = Math.round(Math.abs((date.getTime() - date2.getTime())/(oneDay)));

                                                if(diffDays<=365){
                                                    var index = 365 -diffDays;
                                                    count[index]++;
                                                    total++;
                                                    console.log(total);
                                                    console.log(count);
                                                    
                                                }


                                        }
                                    }

                               },
                               error : function() {
                                //mean no commit is in the API

                                }

                           });

                            $.ajax({
                                type:'GET',
                                dataType:'json',
                                url:reposUrl+'/pulls',

                               success:function(data2){
                                 for(n=0;n<data2.length;n++){
                                   if(data2[n].assignee.login.toLowerCase()===username){
                                     var time= data2[n].updated_at;
                                      var y = parseInt(time.substring(0,4),10);
                                      var m =  parseInt(time.substring(5,7),10);
                                      var d =  parseInt(time.substring(8,10),10);
                                      var date = new Date();
                                      var date2 = new Date(y,m-1,d );
                                      var diffDays = Math.round(Math.abs((date.getTime() - date2.getTime())/(oneDay)));

                                      if(diffDays<=365){
                                          var index = 365 -diffDays;
                                          count[index]++;
                                          total++;
                                          console.log(total);
                                          console.log(count);
                                      }
                                   }
                                 }

                               },
                               error : function() {
                                //mean no pulls is in the API
                                //mean no pulls is in the API

                                }

                         });

                            $.ajax({//Get the Issuses data from API
                                type:'GET',
                                dataType:'json',
                                url:reposUrl+'/issues',
                                success:function(data3){
                                 for(c=0;c<data2.length;c++){
                                     if(data2[c].user.login.toLowerCase()===username){// check who opened this issues
                                            var time= data2[c].updated_at;
                                            var y = parseInt(time.substring(0,4),10);
                                            var m=parseInt(time.substring(5,7),10);
                                            var d =parseInt(time.substring(8,10),10);
                                            var date = new Date();
                                            var date2 = new Date(y,m-1,d)
                                            var diffDays = Math.round(Math.abs((date.getTime() -   date2.getTime())/(oneDay)));
                                            if(diffDays<=365){
                                                var index = 365 -diffDays;
                                                count[index]++;
                                                total++;
                                                console.log(total);
                                                console.log(count);
                                            }
                                     }
                                 }
                               },
                               error : function() {
                                //mean no issues is in the API


                                }

                         });

                       }


               },
               error : function() {

              },

            });


        });


    });


    </script>


    </body>

</html>
